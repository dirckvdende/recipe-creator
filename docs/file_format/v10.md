
# Recipe file encoding v10

View the [README](./README.md) for instructions on how to read this document.

The entire encoding can be summarized as follows:

| [#initial-bytes](#initial-bytes) | u8 | s | u4 | [#section](#section)\[n\]
| - | - | - | - | - |
| initial bytes | encoding version, should be 10 | recipe title | n | recipe sections |

## Initial bytes

The initial bytes are `0x89` followed by a ASCII encoded string `"Cooking Recipe Creator file. Do not modify using a text editor. Visit https://dirckvdende.github.io/recipe-creator to read and modify the file."` (without null byte), followed by the bytes `0x0d0a1a0a`. This is based on the PNG format ([Wikipedia](https://en.wikipedia.org/wiki/PNG#File_format)).

| `89` |
| - |
| initial byte |

| `43` `6f` `6f` `6b` `69` `6e` `67` `20` `52` `65` |
| - |
| "Cooking Re" |

| `63` `69` `70` `65` `20` `43` `72` `65` `61` `74` |
| - |
| "cipe Creat" |

| `6f` `72` `20` `66` `69` `6c` `65` `2e` `20` `44` |
| - |
| "or file. D" |

| `6f` `20` `6e` `6f` `74` `20` `6d` `6f` `64` `69` |
| - |
| "o not modi" |

| `66` `79` `20` `75` `73` `69` `6e` `67` `20` `61` |
| - |
| "fy using a" |

| `20` `74` `65` `78` `74` `20` `65` `64` `69` `74` |
| - |
| " text edit" |

| `6f` `72` `2e` `20` `56` `69` `73` `69` `74` `20` |
| - |
| "or. Visit " |

| `68` `74` `74` `70` `73` `3a` `2f` `2f` `64` `69` |
| - |
| "https://di" |

| `72` `63` `6b` `76` `64` `65` `6e` `64` `65` `2e` |
| - |
| "rckvdende." |

| `67` `69` `74` `68` `75` `62` `2e` `69` `6f` `2f` |
| - |
| "github.io/" |

| `72` `65` `63` `69` `70` `65` `2d` `63` `72` `65` |
| - |
| "recipe-cre" |

| `61` `74` `6f` `72` `20` `74` `6f` `20` `72` `65` |
| - |
| "ator to re" |

| `61` `64` `20` `61` `6e` `64` `20` `6d` `6f` `64` |
| - |
| "ad and mod" |

| `69` `66` `79` `20` `74` `68` `65` `20` `66` `69` |
| - |
| "ify the fi" |

| `6c` `65` `2e` |
| - |
| "le." |

| `0d` `0a` `1a` `0a` |
| - |
| Extra bytes |

## Section

A section is encoded first with its type using one byte, followed by the section data, which is dependent on the type.

| u1 | [#text-section](#text-section) (if type=0) [#image-section](#image-section) (if type=1) [#ingredients-section](#ingredients-section) (if type=2) [#tags-section](#tags-section) (if type=3) [#steps-section](#steps-section) (if type=4) ERROR (otherwise) |
| - | - |
| type | section |

### Text section

A text section is encoded with two strings, its title and its content.

| s | s |
| - | - |
| title | content |

### Image section

An image section is encoded with its MIME type, an int indicating the size of the image in bytes, and the raw bytes of the image file. This means that for example JPEG files keep treir compression when being encoded in a recipe file.

| s | u4 | b1\[length\] |
| - | - | - |
| MIME type | length | data |

### Ingredients section

This section contains a title and a number of ingredients, followed by the list of ingredients.

| s | u4 | [#ingredient](#ingredient)\[length\] |
| - | - | - |
| title | length | ingredients list |

#### Ingredient

Ingredients have the following information: Whether the checkbox in front of the ingredient is checked, the amount of the ingredient used, and the name of the ingredient.

| u1 | s | s |
| - | - | - |
| checked, should be 0 or 1 | amount | name |

### Tags section

The tags section is simply a collection of strings, the use of macros and display of icons is implemented by the web app and not by the encoder/decoder.

| u4 | s\[length\] |
| - | - |
| length | tags |

### Steps section

The steps section contains a title and number of steps, followed by the steps.

| s | u4 | [#step](#step)\[length\] |
| - | - | - |
| title | length | steps list |

#### Step

A step has a type and content. There are two types: "normal" and "wait", which are used for usual steps in a cooking recipe and waiting times, respectively.

| u1 | s |
| - | - |
| type, 0=normal, 1=wait, any other value gives error | content